{
  "rules": {
    "entities": {
      ".read": "true",
      ".write": "false"
    },

    "rooms": {
      ".read": "true",
      ".write": "true",

      "$roomId": {
        "members": {
          "$member": {
            ".validate": "!root.child('users/' + $member + '/room').exists() &&
              (auth.uid == $roomId || auth.uid == $member)"
          }
        },
        "$other": {
          ".write": "true",
          ".validate": "auth.uid == $roomId"
        }
      }
    },

    "users": {
      ".read": "true",

      "$userId": {
        ".write": "auth.uid == $userId"
      }
    },

    "$other": {
      ".read": "true",
      ".write": "true"
    }
  }
}